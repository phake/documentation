<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Partial Mocks</title><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/><link rel="home" href="index.html" title="Phake - PHP Mocking Framework"/><link rel="up" href="ch03.html" title="Chapter 3. Method Stubbing"/><link rel="prev" href="ch03s09.html" title="Custom Answers"/><link rel="next" href="ch03s11.html" title="Setting Default Stubs"/></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Partial Mocks</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch03s09.html">Prev</a> </td><th width="60%" align="center">Chapter 3. Method Stubbing</th><td width="20%" align="right"> <a accesskey="n" href="ch03s11.html">Next</a></td></tr></table><hr/></div><div class="section" title="Partial Mocks"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a xmlns:saxon="http://icl.com/saxon" id="d4e170"/>Partial Mocks</h2></div></div></div>
		<p>
			When testing legacy code, if you find that the majority of the methods in the mock are using the thenCallParent() answer, you may find it easier to just use a partial mock in Phake. Phake partial mocks also allow you to call the actual constructor of the class being mocked. They are created using Phake::partialMock(). Like Phake::mock(), the first parameter is the name of the class that you are mocking. However, you can pass additional parameters that will then be passed as the respective parameters to that class’ constructor. The other notable feature of a partial mock in Phake is that its default answer is to pass the call through to the parent as if you were using thenCallParent().
		</p>
		<p>
			Consider the following class that has a method that simply returns the value passed into the constructor.
		</p>
		<div class="example"><a xmlns:saxon="http://icl.com/saxon" id="method-stubbing.partial-mock"/><p class="title"><b>Example 3.9. A Test Class</b></p><div class="example-contents">
	
		<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?php</span>
<b class="hl-keyword">class</b> MyClass
{
	<b class="hl-keyword">private</b> $value;

	<b class="hl-keyword">public</b> __construct($value)
	{
		$this-&gt;value = $value;
	}

	<b class="hl-keyword">public</b> <b class="hl-keyword">function</b> foo()
	{
		<b class="hl-keyword">return</b> $this-&gt;value;
	}
}
<span class="hl-directive" style="color: maroon">?&gt;</span></pre>
</div></div><br class="example-break"/>
		<p>
			Using Phake::partMock() you can instantiate a mock object that will allow this object to function
			as designed while still allowing verification as well as selective stubbing of certain calls.
			Below is an example that shows the usage of Phake::partMock()
		</p>
		<div class="example"><a xmlns:saxon="http://icl.com/saxon" id="method-stubbing.test-partial-mock"/><p class="title"><b>Example 3.10. Using Partial Mocks</b></p><div class="example-contents">
	
		<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?php</span>
<b class="hl-keyword">class</b> MyClassTest <b class="hl-keyword">extends</b> PHPUnit_Framework_TestCase
{
	<b class="hl-keyword">public</b> <b class="hl-keyword">function</b> testCallingParent()
	{
		$mock = Phake::partialMock(<b class="hl-string"><i style="color:red">'MyClass'</i></b>, <span class="hl-number">42</span>);

		$this-&gt;assertEquals(<span class="hl-number">42</span>, $mock-&gt;foo());
	}
}
<span class="hl-directive" style="color: maroon">?&gt;</span></pre>
</div></div><br class="example-break"/>
		<p>
			Again, partial mocks should not be used when you are testing new code. If you find yourself using them be sure to inspect your design to make sure that the class you are creating a partial mock is not doing too much.
		</p>
	</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch03s09.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch03.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch03s11.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Custom Answers </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Setting Default Stubs</td></tr></table></div></body></html>