<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Verifying Magic Methods</title><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/><link rel="home" href="index.html" title="Phake - PHP Mocking Framework"/><link rel="up" href="ch02.html" title="Chapter 2. Method Verification"/><link rel="prev" href="ch02s06.html" title="Verifying No Further Interaction with a Mock"/><link rel="next" href="ch03.html" title="Chapter 3. Method Stubbing"/></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Verifying Magic Methods</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch02s06.html">Prev</a> </td><th width="60%" align="center">Chapter 2. Method Verification</th><td width="20%" align="right"> <a accesskey="n" href="ch03.html">Next</a></td></tr></table><hr/></div><div class="section" title="Verifying Magic Methods"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a xmlns:saxon="http://icl.com/saxon" id="d4e92"/>Verifying Magic Methods</h2></div></div></div>
		<p>
			Magic methods are commonly used in PHP and the need to be able to seemlessly utilize them is always necessary. Most magic methods can be verified using the method name just like you would any other method. The one exception to this is the __call() method. This method is overwritten on each mock already to allow for the fluent api that Phake utilizes. If you want to verify a particular invoaction of __call() you can verify the actual method call by mocking the method passed in as the first parameter.
		</p>
		<p>
			Consider the following class.
		</p>
		<div class="example"><a xmlns:saxon="http://icl.com/saxon" id="method-verification.magic-class"/><p class="title"><b>Example 2.7. A Magic Class</b></p><div class="example-contents">
	
		<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?php</span>
<b class="hl-keyword">class</b> MagicClass
{
<b class="hl-keyword">public</b> <b class="hl-keyword">function</b> __call($method, $args)
{
<b class="hl-keyword">return</b> <b class="hl-string"><i style="color:red">'__call'</i></b>;
}
}
<span class="hl-directive" style="color: maroon">?&gt;</span></pre>
</div></div><br class="example-break"/>
		<p>
			You could mock an invocation of the __call() method through a userspace call to magicCall() with the following code.
		</p>
		<div class="example"><a xmlns:saxon="http://icl.com/saxon" id="method-verification.magic-method-verify"/><p class="title"><b>Example 2.8. Implicitly Verify __call()</b></p><div class="example-contents">
	
		<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?php</span>
<b class="hl-keyword">class</b> MagicClassTest <b class="hl-keyword">extends</b> PHPUnit_Framework_TestCase
{
  <b class="hl-keyword">public</b> <b class="hl-keyword">function</b> testMagicCall()
  {
    $mock = Phake::mock(<b class="hl-string"><i style="color:red">'MagicClass'</i></b>);

    $mock-&gt;magicCall();

    Phake::verify($mock)-&gt;magicCall();
  }
}
<span class="hl-directive" style="color: maroon">?&gt;</span></pre>
</div></div><br class="example-break"/>
		<p>
			If for any reason you need to explicitely verify calls to __call() then you can use Phake::verifyCallMethodWith().
		</p>
		<div class="example"><a xmlns:saxon="http://icl.com/saxon" id="method-verification.magic-method-explicit-verify"/><p class="title"><b>Example 2.9. Explicitly Verify __call()</b></p><div class="example-contents">
	
		<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?php</span>
<b class="hl-keyword">class</b> MagicClassTest <b class="hl-keyword">extends</b> PHPUnit_Framework_TestCase
{
  <b class="hl-keyword">public</b> <b class="hl-keyword">function</b> testMagicCall()
  {
    $mock = Phake::mock(<b class="hl-string"><i style="color:red">'MagicClass'</i></b>);

    $mock-&gt;magicCall();

    Phake::verifyCallMethodWith(<b class="hl-string"><i style="color:red">'magicCall'</i></b>)-&gt;isCalledOn($mock);
  }
}
<span class="hl-directive" style="color: maroon">?&gt;</span></pre>
</div></div><br class="example-break"/>
		<p>
			This last section is purposely vague as this method of explicitly verifying statics will likely be replaced in the very near future.
		</p>
	</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch02s06.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch02.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch03.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Verifying No Further Interaction with a Mock </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 3. Method Stubbing</td></tr></table></div></body></html>