<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Calling the Parent</title><meta name="generator" content="DocBook XSL Stylesheets V1.75.2" /><link rel="home" href="index.html" title="Phake - PHP Mocking Framework" /><link rel="up" href="ch03.html" title="Chapter 3. Method Stubbing" /><link rel="prev" href="ch03s06.html" title="Throwing Exceptions" /><link rel="next" href="ch03s08.html" title="Capturing a Return Value" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Calling the Parent</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch03s06.html">Prev</a> </td><th width="60%" align="center">Chapter 3. Method Stubbing</th><td width="20%" align="right"> <a accesskey="n" href="ch03s08.html">Next</a></td></tr></table><hr /></div><div class="section" title="Calling the Parent"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1409913"></a>Calling the Parent</h2></div></div></div>
		<p>
			Phake provides the ability to allow calling the actual method of an object on a method by method
			basis by using the thenCallParent() answer. This will result in the actual method being called.
			Consider the following class.
		</p>
		<div class="example"><a id="method-stubbing.call-parent-class"></a><p class="title"><b>Example 3.7. A Test Class</b></p><div class="example-contents">
	
		<pre class="programlisting">&lt;?php
class MyClass
{
	public function foo()
	{
		return '42';
	}
}
?&gt;</pre>
</div></div><br class="example-break" />
		<p>
			The thenCallParent() answer can be used here to ensure that the actual method in the class is 
			called resulting in the value 42 being returned from calls to that mocked method.
		</p>
		<div class="example"><a id="method-stubbing.test-call-parent-class"></a><p class="title"><b>Example 3.8. Using thenCallParent() to Force a Stub to Call its Parent</b></p><div class="example-contents">
	
		<pre class="programlisting">&lt;?php
class MyClassTest extends PHPUnit_Framework_TestCase
{
	public function testCallingParent()
	{
		$mock = Phake::mock('MyClass');
		Phake::when($mock)-&gt;foo()-&gt;thenCallParent();

		$this-&gt;assertEquals(42, $mock-&gt;foo());
	}
}
?&gt;</pre>
</div></div><br class="example-break" />
		<p>
			Please avoid using this answer as much as possible especially when testing newly written code. If you find yourself requiring a class to be only partially mocked then that is a code smell for a class that is likely doing too much. An example of when this is being done is why you are testing a class that has a singular method that has a lot of side effects that you want to mock while you allow the other methods to be called as normal. In this case that method that you are desiring to mock should belong to a completely separate class. It is obvious by the very fact that you are able to mock it without needing to mock other messages that it performs a different function.
		</p>
		<p>
			Even though partial mocking should be avoided with new code, it is often very necessary to allow creating tests while refactoring legacy code, tests involving 3rd party code that can’t be changed, or new tests of already written code that cannot yet be changed. This is precisely the reason why this answer exists and is also why it is not the default answer in Phake.
		</p>
	</div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch03s06.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch03.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch03s08.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Throwing Exceptions </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Capturing a Return Value</td></tr></table></div></body></html>
